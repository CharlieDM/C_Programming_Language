---
typora-copy-images-to: images
---

### 函数

函数名：本质上是指函数代码在内存中的首字节地址，是一个地址常量，实际上直接写函数地址的形式，也是可以调用函数的，比如：0x27364748(20,30)

指针作函数参数，具有输入输出特性，加const修饰指针可以防止实参被修改

![1499778188661](images/1499778188661.png)

### 函数的形参和实参

- 形参出现在函数定义中，在整个函数体内都可以使用，离开该函数则不能使用。
- 实参出现在主调函数中，进入被调函数后，实参也不能使用。
- 实参变量对形参变量的数据传递是“值传递”，即单向传递，只由实参传给形参，而不能由形参传回来给实参。
- 在调用函数时，编译系统临时给形参分配存储单元。调用结束后，形参单元被释放。
- 实参单元与形参单元是不同的单元。调用结束后，形参单元被释放，函数调用结束返回主调函数后则不能再使用该形参变量。实参单元仍保留并维持原值。因此，在执行一个被调用函数时，形参的值如果发生改变，并不会改变主调函数中实参的值

### 函数定义和声明的区别

1）定义是指对函数功能的确立，包括指定函数名、函数类型、形参及其类型、函数体等，它是一个完整的、独立的函数单位。
2）声明的作用则是把函数的名字、函数类型以及形参的个数、类型和顺序(注意，不包括函数体)通知编译系统，以便在对包含函数调用的语句进行编译时，据此对其进行对照检查（例如函数名是否正确，实参与形参的类型和个数是否一致）。

### 外部函数

```
extern int add(int x, int y);
```

### 内部函数（静态函数）

```
static void show(int x){
  	print("%d",x);
}
```

### 函数库

静态链接库：.a 归档文件（库文件）

动态链接库：共享库

### 常见的库函数

字符串函数，声明在string.h中

| 函数声明    | 功能描述 |
| ------- | ---- |
| memcpy  |      |
| memmove |      |
| memset  |      |
| memcmp  |      |
| memchr  |      |
| strcpy  |      |
| strncpy |      |
| strcmp  |      |
| strncm  |      |
| strdup  |      |
| strndup |      |
| strchr  |      |
| strstr  |      |
| strtok  |      |

man手册

![1499696049114](images/1499696049114.png)

man手册的使用

数学库函数，math.h



### 内存四区

- 栈：用来存放局部变量、函数参数等
  - 空间实现自动管理：自动分配，自动释放
  - 能够被反复使用
  - 脏内存
  - 临时性
- 堆：动态分配，malloc()，free()
- 数据区
  - 静态全局区：用于存储全局变量和静态变量的区域
  - 常量区：存储字符串常量和其它常量的区域
- 代码区：用于存放函数体的二进制代码

### 虚拟地址

![](images/虚拟地址空间.png)

### 函数调用模型变量传递分析

![1499585103904](images/1499585103904.png)

### 存储类

就是存储类型，栈，堆，数据段，bss段，text段

auto 修饰局部变量，自动局部变量，分配在栈上，普通的局部变量默认就是auto修饰的

static 修饰局部变量，静态局部变量，分配在data段或bss段，生命周期和全局变量一样，作用域是代码块作用域，链接属性是无链接；

修饰全局变量，静态全局变量

全局变量，作用域是文件作用域，链接属性是外链接

register 寄存器变量，修饰变量时，编译器会尽量分配在寄存器中，提高访问效率

extern 修饰全局变量，实现跨文件访问变量，extern int var;

volatile 编译器在遇到volatile修饰的变量时不会对其进行优化（java中会禁止指令重排）

restrict 用于限定和约束指针，所有希望修改该指针指向的内存时，都必须使用该指针才可以进行，目的是让编译器进行更好的优化

typedef 给类型起别名

### 作用域

描述这个变量起作用的代码范围

代码块作用域

文件作用域

### 生命周期

### 链接属性

预编译，编译，汇编，链接

三种链接属性：

外链接：跨文件访问，extern修饰的全局变量和函数

内链接：static静态修饰全局变量和函数

无链接：局部变量（auto和static的）

### 命名冲突问题 

static修饰，内链接

### Linux的内存映像

![1499696890106](images/1499696890106.png)

内核空间3G~4G，用户空间 0G~3G

text，rodada 只读数据段

data 初始化的数据，bss 未初始化的数据

堆，动态分配的内存，malloc

栈，也叫临时区，存放局部变量，函数参数等

### 函数数据类型

